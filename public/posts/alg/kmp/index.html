<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>KMP算法-来自leetcode-28的思考 | Whitea's Blog</title>
<meta name=keywords content="alg"><meta name=description content="快来看看学了就会忘记的kmp吧"><meta name=author content="Whitea"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://whitea029.github.io/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://whitea029.github.io/images/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://whitea029.github.io/images/favicon-32x32.png><link rel=apple-touch-icon href=https://whitea029.github.io/images/apple-touch-icon.png><link rel=mask-icon href=https://whitea029.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://whitea029.github.io/posts/alg/kmp/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://whitea029.github.io/posts/alg/kmp/"><meta property="og:site_name" content="Whitea's Blog"><meta property="og:title" content="KMP算法-来自leetcode-28的思考"><meta property="og:description" content="快来看看学了就会忘记的kmp吧"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-06-20T11:30:03+00:00"><meta property="article:modified_time" content="2024-06-20T11:30:03+00:00"><meta property="article:tag" content="Alg"><meta property="og:image" content="https://whitea029.github.io/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://whitea029.github.io/%3Cimage%20path/url%3E"><meta name=twitter:title content="KMP算法-来自leetcode-28的思考"><meta name=twitter:description content="快来看看学了就会忘记的kmp吧"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://whitea029.github.io/posts/"},{"@type":"ListItem","position":2,"name":"KMP算法-来自leetcode-28的思考","item":"https://whitea029.github.io/posts/alg/kmp/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"KMP算法-来自leetcode-28的思考","name":"KMP算法-来自leetcode-28的思考","description":"快来看看学了就会忘记的kmp吧","keywords":["alg"],"articleBody":"本文的思考来自于leetcode-28.找出字符串中第一个匹配项的下标leetcode链接\n什么是KMP算法 在计算机科学中，克努斯-莫里斯-普拉特字符串查找算法（英语：Knuth–Morris–Pratt algorithm，简称为KMP算法）可在一个字符串S内查找一个词W的出现位置。一个词在不匹配时本身就包含足够的信息来确定下一个匹配可能的开始位置，此算法利用这一特性以避免重新检查先前配对的字符。（引用维基百科）\n也就是说KMP算法是用来解决字符串匹配问题，即从一个文本串text中寻找一个子字符串（模式串）pattern，看这个字串是否在主串中出现过。比如对于 text='abaacababcac' 和 pattern='ababc'，子串是包含在主串中的，同时它在主串中的索引是5\n暴力算法 暴力解法即为两个for循环，将两个字符串挨个进行比较\n第一个for循环对文本串text循环，表示开始对比的起点\n第二个for循环对模板串循环，依次从文本串对比的起点挨个进行对比，不符合即跳出内层for循环，符合那就找到啦\n不难看出，这样操作所导致的时间复杂度为O(m * n)，即两个字符串长度的乘积，其造成此时间复杂度的原因是每一次比对不符合时跳出循环都要重新挨个比对，浪费了大量的时间，而KMP算法正是为了解决此问题。以下为暴力算法的Java代码实现，后文不多赘述\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 public int strStr(String text, String pattern) { for (int i = 0; i + pattern.length() \u003c= text.length(); i++) { boolean flag = true; for (int j = 0; j \u003c pattern.length(); j++) { if (text.charAt(i + j) != pattern.charAt(j)) { flag = false; break; } } if (flag) { return i; } } return -1; } KMP算法 在了解使用KMP算法解决字符串匹配问题之前应先了解相关的前置知识。\n为什么使用KMP算法 KMP算法的聪明之处在于当出现字符串不匹配问题时候，可以利用已经匹配成功的字符串所提供的一些有用信息将子串移动到某个位置，从该位置开始匹配，此时的时间复杂度为O(m + n)，即两个字符串的长度的和。\n实现KMP算法的重点是找出**next(prefix)**数组（前缀表），也是算法思想的难点，接下来介绍到底何为前缀，后缀，何为前缀表。\n前缀 后缀 前缀：对于一个字符串而言，从左到右包括首字母，不包括尾字母的所有字串都称之为前缀。\n后缀：对于一个字符串而言，从左到右不包括首字母，包括尾字母的所有子串都称之为后缀。\n重点：后缀也是从左向右看！！！这对之后理解算法流程有很大作用\neg：模板串aabaaf中，前缀为a,aa,aab,aaba,aabaa后缀为f,af,aaf,baaf,abaaf\n前缀表 前缀表就是一个数组，一般称之为next数组或者prefix table\n前缀表的功能就是用来回退的，它记录着当模板串和文本串不匹配的时候，应该回退到文本串的什么地方重新开始匹配\n那前缀表中记录的是什么呢？前缀表记录的是：该字符串下标**i**处（包括**i**）之前的子串，最大相等前后缀的长度\neg：模板串为aabaaf时，\ni = 0时，子串为a，最大相等前后缀为0\ni = 1时，子串为aa，最大相等前后缀为1\ni = 2时，子串为aab，最大相等前后缀为0\ni = 3时，子串为aaba，最大相等前后缀为1\ni = 4时，子串为aabaa，最大相等前后缀为2\ni = 5时，子串为aabaaf，最大相等前后缀为0\n所以前缀表为[0, 1, 0, 1, 2, 0]\n那为什么前缀表能让我们在遇到字符串不匹配的时候快速重新定位新的匹配起点呢？\n算法流程 下面举例均使用 文本串aabaabaaf 模板串aabaaf作为样例\n依然要采用嵌套循环的方式，指针**i**指向文本串，指针**j**指向模板串\n在第一次匹配的时候，当匹配到字母f的时候发现与文本串的b不匹配，此时就要利用前缀表进行指针**j**回溯，前缀表怎么看呢？\n我们看aabaaf的前缀表[0, 1, 0, 1, 2, 0]中此时指针j指向字母的前一位的字符a对应的前缀表为2，那么此时回溯（移动**j**指针）到模板串下标为2的地方即字符b处重新开始匹配。\n为什么？？？\n因为循环在走到f之前已经完全匹配上了前面的aabaa，我们又从前缀表中得知aabaa的最长相同前后缀为aa，长度为2\n这是一个非常好的提示，这告诉我们已经匹配的**aabaa**子串中，**aa****已经不用匹配了！**因为文本串中的aabaa的前缀aa和模板串中的aabaa的后缀aa相同！！！\n此时将指针i与指针j对齐，继续匹配！\n接下来重复上面的思想，直到完全匹配上。\n显然，KMP算法的实现相比于暴力求解，指针i并没有进行回溯（最多就是原地不动）这是KMP算法的优势。\n计算前缀表 上面的实现是前缀表的一种实现，但是有一种更常用的前缀表实现方式，即将上面的前缀表整体减一，方便条件的界定和指针j的回溯\n初始化 处理前后缀不相同的情况 处理前后缀相同的情况 统一减一\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 public static void getNext(int[] next, String s) { // 初始化 int j = -1; next[0] = j; // 对模板串进行for循环 for (int i = 1; i \u003c s.length(); i++) { // 注意i从1开始（因为0位置已经初始化不用比较） // 当不匹配的时候的处理，利用while循环 while (j \u003e= 0 \u0026\u0026 s.charAt(i) != s.charAt(j + 1)) { // 注意这里是j + 1(因为统一减一) j = next[j]; // 指针j回退 } // 当匹配的时候的处理 if (s.charAt(i) == s.charAt(j + 1)) { j++; } // 记录前缀表 next[i] = j; } } 统一不减一\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 public void getNext(int[] next, String s) { // 初始化 int j = 0; next[0] = 0; // 对模板串进行for循环 for (int i = 1; i \u003c s.length(); i++) { // 注意i从1开始（因为0位置已经初始化不用比较 // 当不匹配的时候的处理，利用while循环 while (j \u003e 0 \u0026\u0026 s.charAt(i) != s.charAt(j)) { // j要保证大于0 j = next[j - 1]; // 指针j回退 } // 当匹配的时候的处理 if (s.charAt(i) == s.charAt(j)) { j++; } // 记录前缀表 next[i] = j; } } KMP算法实现 统一减一\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 public int strStr(String haystack, String needle) { if (needle.length() == 0) { return 0; } int[] next = new int[needle.length()]; getNext(next, needle); int j = -1; // next数组里记录的起始位置为-1 for (int i = 0; i \u003c haystack.length(); i++) { // 注意i从0开始 while (j \u003e= 0 \u0026\u0026 haystack.charAt(i) != needle.charAt(j + 1)) { // 不匹配 j = next[j]; // j寻找之前匹配的位置 } if (haystack.charAt(i) == needle.charAt(j + 1)) { // 匹配，j和i同时向后移动 j++; // i的增加在for循环里 } if (j == needle.length() - 1) { // 文本串haystack里出现了模式串needle return i - needle.length() + 1; } } return -1; } public void getNext(int[] next, String s) {………} 统一不减一\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 public int strStr(String haystack, String needle) { if (needle.length() == 0) { return 0; } int[] next = new int[needle.length()]; getNext(next, needle); int j = 0; for (int i = 0; i \u003c haystack.length(); i++) { while (j \u003e 0 \u0026\u0026 haystack.charAt(i) != needle.charAt(j)) { j = next[j - 1]; } if (haystack.charAt(i) == needle.charAt(j)) { j++; } if (j == needle.length()) { return (i - needle.length() + 1); } } return -1; } public void getNext(int[] next, String s) {………} 总结 以上就是KMP算法的核心原理及实现，当然KMP的实现方法不止上面一种，因此对应的next数组也有所不同，但是算法核心思想已经在上面简要阐述清楚。\n作为一名小白刷题者,文章存在有任何问题都可以联系我，当然也欢迎与我交流技术相关的问题，感谢你的阅读🤗\n","wordCount":"574","inLanguage":"en","image":"https://whitea029.github.io/%3Cimage%20path/url%3E","datePublished":"2024-06-20T11:30:03Z","dateModified":"2024-06-20T11:30:03Z","author":{"@type":"Person","name":"Whitea"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://whitea029.github.io/posts/alg/kmp/"},"publisher":{"@type":"Organization","name":"Whitea's Blog","logo":{"@type":"ImageObject","url":"https://whitea029.github.io/images/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://whitea029.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://whitea029.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://whitea029.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://whitea029.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://whitea029.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://whitea029.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">KMP算法-来自leetcode-28的思考</h1><div class=post-description>快来看看学了就会忘记的kmp吧</div><div class=post-meta><span title='2024-06-20 11:30:03 +0000 +0000'>June 20, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;574 words&nbsp;·&nbsp;Whitea&nbsp;|&nbsp;<a href=https://github.com/Whitea029/myblog/blob/main/content/posts/alg/kmp/index.md rel="noopener noreferrer" target=_blank>Source Code</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#什么是kmp算法>什么是KMP算法</a></li><li><a href=#暴力算法>暴力算法</a></li><li><a href=#kmp算法>KMP算法</a><ul><li><a href=#为什么使用kmp算法>为什么使用KMP算法</a></li><li><a href=#前缀-后缀>前缀 后缀</a></li><li><a href=#前缀表>前缀表</a></li><li><a href=#算法流程>算法流程</a></li><li><a href=#计算前缀表>计算前缀表</a></li><li><a href=#kmp算法实现>KMP算法实现</a></li></ul></li><li><a href=#总结>总结</a></li></ul></nav></div></details></div><div class=post-content><p>本文的思考来自于<code>leetcode-28.找出字符串中第一个匹配项的下标</code><a href=https://leetcode.cn/problems/find-the-index-of-the-first-occurrence-in-a-string/solutions/732236/shi-xian-strstr-by-leetcode-solution-ds6y/>leetcode链接</a></p><h2 id=什么是kmp算法>什么是KMP算法<a hidden class=anchor aria-hidden=true href=#什么是kmp算法>#</a></h2><blockquote><p>在<a href=https://zh.wikipedia.org/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6>计算机科学</a>中，<strong>克努斯-莫里斯-普拉特</strong><a href=https://zh.wikipedia.org/wiki/%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95>字符串查找算法</a>（英语：Knuth–Morris–Pratt algorithm，简称为<strong>KMP算法</strong>）可在一个<a href=https://zh.wikipedia.org/wiki/%E5%AD%97%E7%AC%A6%E4%B8%B2>字符串</a>S内查找一个词W的出现位置。一个词在不匹配时本身就包含足够的信息来确定下一个匹配可能的开始位置，此算法利用这一特性以避免重新检查先前配对的<a href=https://zh.wikipedia.org/wiki/%E5%AD%97%E7%AC%A6>字符</a>。（引用维基百科）</p></blockquote><p>也就是说KMP算法是用来解决字符串匹配问题，即从一个文本串<code>text</code>中寻找一个子字符串（模式串）<code>pattern</code>，看这个字串是否在主串中出现过。比如对于 <code>text='abaacababcac'</code> 和 <code>pattern='ababc'</code>，子串是包含在主串中的，同时它在主串中的索引是<code>5</code></p><h2 id=暴力算法>暴力算法<a hidden class=anchor aria-hidden=true href=#暴力算法>#</a></h2><p>暴力解法即为两个<code>for</code>循环，将两个字符串挨个进行比较</p><p>第一个<code>for</code>循环对文本串<code>text</code>循环，表示开始<strong>对比的起点</strong></p><p>第二个<code>for</code>循环对模板串循环，依次从文本串<strong>对比的起点</strong>挨个进行对比，不符合即跳出内层<code>for</code>循环，符合那就找到啦</p><p>不难看出，这样操作所导致的时间复杂度为<code>O(m * n)</code>，即两个字符串长度的乘积，其造成此时间复杂度的<strong>原因</strong>是每一次比对不符合时跳出循环都要重新挨个比对，浪费了大量的时间，而KMP算法正是为了解决此问题。以下为暴力算法的Java代码实现，后文不多赘述</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=nf>strStr</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>text</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>pattern</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>pattern</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>text</span><span class=p>.</span><span class=na>length</span><span class=p>();</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=kt>boolean</span><span class=w> </span><span class=n>flag</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>pattern</span><span class=p>.</span><span class=na>length</span><span class=p>();</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                       </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>text</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>j</span><span class=p>)</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>pattern</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>j</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                       </span><span class=n>flag</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                       </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                   </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>flag</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>return</span><span class=w> </span><span class=n>i</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=o>-</span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=kmp算法>KMP算法<a hidden class=anchor aria-hidden=true href=#kmp算法>#</a></h2><p>在了解使用KMP算法解决字符串匹配问题之前应先了解相关的前置知识。</p><h3 id=为什么使用kmp算法>为什么使用KMP算法<a hidden class=anchor aria-hidden=true href=#为什么使用kmp算法>#</a></h3><p>KMP算法的聪明之处在于<strong>当出现字符串不匹配问题时候，可以利用已经匹配成功的字符串所提供的一些有用信息将子串移动到某个位置，从该位置开始匹配</strong>，此时的时间复杂度为<code>O(m + n)</code>，即两个字符串的长度的和。</p><p>实现KMP算法的重点是找出<code>**next(prefix)**</code>数组（前缀表），也是算法思想的难点，接下来介绍<strong>到底何为前缀，后缀，何为前缀表</strong>。</p><h3 id=前缀-后缀>前缀 后缀<a hidden class=anchor aria-hidden=true href=#前缀-后缀>#</a></h3><p>前缀：对于一个字符串而言，<strong>从左到右</strong>包括<strong>首</strong>字母，不包括<strong>尾</strong>字母的所有字串都称之为前缀。</p><p>后缀：对于一个字符串而言，<strong>从左到右</strong>不包括<strong>首</strong>字母，包括<strong>尾</strong>字母的所有子串都称之为后缀。</p><p><strong>重点：后缀也是从左向右看！！！这对之后理解算法流程有很大作用</strong></p><p>eg：模板串<code>aabaaf</code>中，前缀为<code>a</code>,<code>aa</code>,<code>aab</code>,<code>aaba</code>,<code>aabaa</code>后缀为<code>f</code>,<code>af</code>,<code>aaf</code>,<code>baaf</code>,<code>abaaf</code></p><h3 id=前缀表>前缀表<a hidden class=anchor aria-hidden=true href=#前缀表>#</a></h3><p>前缀表就是一个数组，一般称之为<code>next</code>数组或者<code>prefix table</code></p><p>前缀表的功能就是<strong>用来回退的，它记录着当模板串和文本串不匹配的时候，应该回退到文本串的什么地方重新开始匹配</strong></p><p>那前缀表中记录的是什么呢？前缀表记录的是：<strong>该字符串下标</strong><code>**i**</code><strong>处（包括</strong><code>**i**</code><strong>）之前的子串，最大相等前后缀的长度</strong></p><p>eg：模板串为<code>aabaaf</code>时，</p><p><code>i = 0</code>时，子串为<code>a</code>，最大相等前后缀为<code>0</code></p><p><code>i = 1</code>时，子串为<code>aa</code>，最大相等前后缀为<code>1</code></p><p><code>i = 2</code>时，子串为<code>aab</code>，最大相等前后缀为<code>0</code></p><p><code>i = 3</code>时，子串为<code>aaba</code>，最大相等前后缀为<code>1</code></p><p><code>i = 4</code>时，子串为<code>aabaa</code>，最大相等前后缀为<code>2</code></p><p><code>i = 5</code>时，子串为<code>aabaaf</code>，最大相等前后缀为<code>0</code></p><p>所以前缀表为<code>[0, 1, 0, 1, 2, 0]</code></p><p>那为什么前缀表能让我们在遇到字符串不匹配的时候快速重新定位新的匹配起点呢？</p><h3 id=算法流程>算法流程<a hidden class=anchor aria-hidden=true href=#算法流程>#</a></h3><p>下面举例均使用 文本串<code>aabaabaaf</code> 模板串<code>aabaaf</code>作为样例</p><p>依然要采用嵌套循环的方式，<strong>指针</strong><code>**i**</code>指向<strong>文本串</strong>，<strong>指针</strong><code>**j**</code>指向<strong>模板串</strong></p><p><img loading=lazy src=/images/kmp/001.png></p><p>在第一次匹配的时候，当匹配到字母f的时候发现与文本串的b不匹配，此时就要利用前缀表进行<strong>指针</strong><code>**j**</code>回溯，前缀表怎么看呢？</p><p>我们看<code>aabaaf</code>的前缀表<code>[0, 1, 0, 1, 2, 0]</code>中此时<strong>指针j指向字母的前一位</strong>的字符a对应的前缀表为<code>2</code>，那么此时回溯（移动<code>**j**</code><strong>指针</strong>）到<strong>模板串</strong>下标为<code>2</code>的地方即字符<code>b</code>处重新开始匹配。</p><p><img loading=lazy src=/images/kmp/002.png></p><p>为什么？？？</p><p>因为循环在走到f之前已经完全匹配上了前面的<code>aabaa</code>，我们又从前缀表中得知aabaa的最长相同前后缀为<code>aa</code>，长度为<code>2</code></p><p><strong>这是一个非常好的提示，这告诉我们已经匹配的</strong><code>**aabaa**</code><strong>子串中，</strong><code>**aa**</code>**已经不用匹配了！**因为文本串中的aabaa的前缀<code>aa</code>和模板串中的<code>aabaa</code>的后缀<code>aa</code>相同！！！</p><p>此时将<strong>指针i与指针j对齐</strong>，继续匹配！</p><p><img loading=lazy src=/images/kmp/003.png></p><p>接下来<strong>重复上面的思想，直到完全匹配上。</strong></p><p>显然，KMP算法的实现相比于暴力求解，指针i并没有进行回溯（最多就是原地不动）这是KMP算法的优势。</p><h3 id=计算前缀表>计算前缀表<a hidden class=anchor aria-hidden=true href=#计算前缀表>#</a></h3><p>上面的实现是前缀表的一种实现，但是有一种更常用的前缀表实现方式，即将上面的前缀表整体<strong>减一</strong>，方便<strong>条件的界定和指针j的回溯</strong></p><ol><li>初始化</li><li>处理前后缀不相同的情况</li><li>处理前后缀相同的情况</li></ol><p>统一减一</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19>19</a>
</span><span class=lnt id=hl-1-20><a class=lnlinks href=#hl-1-20>20</a>
</span><span class=lnt id=hl-1-21><a class=lnlinks href=#hl-1-21>21</a>
</span><span class=lnt id=hl-1-22><a class=lnlinks href=#hl-1-22>22</a>
</span><span class=lnt id=hl-1-23><a class=lnlinks href=#hl-1-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>getNext</span><span class=p>(</span><span class=kt>int</span><span class=o>[]</span><span class=w> </span><span class=n>next</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>s</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 初始化</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>next</span><span class=o>[</span><span class=n>0</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>j</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 对模板串进行for循环</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=na>length</span><span class=p>();</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=c1>// 注意i从1开始（因为0位置已经初始化不用比较）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 当不匹配的时候的处理，利用while循环</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>0</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>1</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=c1>// 注意这里是j + 1(因为统一减一)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>next</span><span class=o>[</span><span class=n>j</span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=c1>// 指针j回退</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 当匹配的时候的处理</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>s</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>1</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>j</span><span class=o>++</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 记录前缀表</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>next</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>j</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>统一不减一</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span><span class=lnt id=hl-2-22><a class=lnlinks href=#hl-2-22>22</a>
</span><span class=lnt id=hl-2-23><a class=lnlinks href=#hl-2-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>getNext</span><span class=p>(</span><span class=kt>int</span><span class=o>[]</span><span class=w> </span><span class=n>next</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>s</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 初始化</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>next</span><span class=o>[</span><span class=n>0</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 对模板串进行for循环</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=na>length</span><span class=p>();</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=c1>// 注意i从1开始（因为0位置已经初始化不用比较</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 当不匹配的时候的处理，利用while循环</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>0</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>j</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=c1>// j要保证大于0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>next</span><span class=o>[</span><span class=n>j</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>1</span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=c1>// 指针j回退</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 当匹配的时候的处理</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>s</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>j</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>j</span><span class=o>++</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 记录前缀表</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>next</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>j</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=kmp算法实现>KMP算法实现<a hidden class=anchor aria-hidden=true href=#kmp算法实现>#</a></h3><p>统一减一</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17>17</a>
</span><span class=lnt id=hl-3-18><a class=lnlinks href=#hl-3-18>18</a>
</span><span class=lnt id=hl-3-19><a class=lnlinks href=#hl-3-19>19</a>
</span><span class=lnt id=hl-3-20><a class=lnlinks href=#hl-3-20>20</a>
</span><span class=lnt id=hl-3-21><a class=lnlinks href=#hl-3-21>21</a>
</span><span class=lnt id=hl-3-22><a class=lnlinks href=#hl-3-22>22</a>
</span><span class=lnt id=hl-3-23><a class=lnlinks href=#hl-3-23>23</a>
</span><span class=lnt id=hl-3-24><a class=lnlinks href=#hl-3-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=nf>strStr</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>haystack</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>needle</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>needle</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=o>[]</span><span class=w> </span><span class=n>next</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=kt>int</span><span class=o>[</span><span class=n>needle</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>getNext</span><span class=p>(</span><span class=n>next</span><span class=p>,</span><span class=w> </span><span class=n>needle</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>1</span><span class=p>;</span><span class=w> </span><span class=c1>// next数组里记录的起始位置为-1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>haystack</span><span class=p>.</span><span class=na>length</span><span class=p>();</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=c1>// 注意i从0开始</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>0</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>haystack</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>needle</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>1</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=c1>// 不匹配</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>next</span><span class=o>[</span><span class=n>j</span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=c1>// j寻找之前匹配的位置</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>haystack</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>needle</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>1</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=c1>// 匹配，j和i同时向后移动</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>j</span><span class=o>++</span><span class=p>;</span><span class=w> </span><span class=c1>// i的增加在for循环里</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>needle</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=c1>// 文本串haystack里出现了模式串needle</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>needle</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>-</span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>getNext</span><span class=p>(</span><span class=kt>int</span><span class=o>[]</span><span class=w> </span><span class=n>next</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>s</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=err>………</span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>统一不减一</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span><span class=lnt id=hl-4-19><a class=lnlinks href=#hl-4-19>19</a>
</span><span class=lnt id=hl-4-20><a class=lnlinks href=#hl-4-20>20</a>
</span><span class=lnt id=hl-4-21><a class=lnlinks href=#hl-4-21>21</a>
</span><span class=lnt id=hl-4-22><a class=lnlinks href=#hl-4-22>22</a>
</span><span class=lnt id=hl-4-23><a class=lnlinks href=#hl-4-23>23</a>
</span><span class=lnt id=hl-4-24><a class=lnlinks href=#hl-4-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=nf>strStr</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>haystack</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>needle</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>needle</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=o>[]</span><span class=w> </span><span class=n>next</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=kt>int</span><span class=o>[</span><span class=n>needle</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>getNext</span><span class=p>(</span><span class=n>next</span><span class=p>,</span><span class=w> </span><span class=n>needle</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>haystack</span><span class=p>.</span><span class=na>length</span><span class=p>();</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>0</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>haystack</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>needle</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>j</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>next</span><span class=o>[</span><span class=n>j</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>1</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>haystack</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>needle</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>j</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>j</span><span class=o>++</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>needle</span><span class=p>.</span><span class=na>length</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>needle</span><span class=p>.</span><span class=na>length</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>-</span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>getNext</span><span class=p>(</span><span class=kt>int</span><span class=o>[]</span><span class=w> </span><span class=n>next</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>s</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=err>………</span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=总结>总结<a hidden class=anchor aria-hidden=true href=#总结>#</a></h2><p>以上就是KMP算法的核心原理及实现，当然KMP的实现方法不止上面一种，因此对应的next数组也有所不同，但是算法核心思想已经在上面简要阐述清楚。</p><blockquote><p>作为一名小白刷题者,文章存在有任何问题都可以联系我，当然也欢迎与我交流技术相关的问题，感谢你的阅读🤗</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://whitea029.github.io/tags/alg/>Alg</a></li></ul><nav class=paginav><a class=prev href=https://whitea029.github.io/posts/sast/first-lesson/><span class=title>« Prev</span><br><span>SAST授课-啥是后端，如何学呢 🤔</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://whitea029.github.io/>Whitea's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>